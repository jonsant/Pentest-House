---
layout: default
---
<< [Home](./)

# Windows Index
* [Commands](#Useful-Commands)
* [Privilege Escalation](#Privilege-Escalation)

## Useful Commands<a name="Useful-Commands"></a>

### Firewall

Disable:
```bash
netsh advfirewall set  currentprofile state off
```

### RDP

Enable (requires admin rights):
```bash
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
```

Disable:
```bash
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 1 /f
```

## Privilege Escalation<a name="Privilege-Escalation"></a>

### List installed patches.

```bash
wmic qfe get Caption,Description,HotFixID,InstalledOn
```

### Find unquoted service paths.
```bash
wmic service get name,displayname,pathname,startmode |findstr /i “Auto” |findstr /i /v “C:\Windows\\” |findstr /i /v “””
```

### Find sensitive information.

Find files with certain keywords.
```bash
dir /s *pass* == *cred* == *vnc* == *.config*
```

Find certain file types with keyword.
```bash
findstr /si password *.xml *.ini *.txt
```

Find keywords in registry.
```bash
reg query HKLM /f password /t REG_SZ /s
reg query HKCU /f password /t REG_SZ /s
```

### See file/folder permissions.
```bash
icacls [path]
```
More on icacls at [microsoft](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/icacls)
